<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.120/Build/Cesium/Cesium.js"></script>
    <link
      href="https://cesium.com/downloads/cesiumjs/releases/1.120/Build/Cesium/Widgets/widgets.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="cesiumContainer"></div>
    <script type="module">
      import CesiumBase from './CesiumBase.js';

      class MyCesium extends CesiumBase {
        createMap() {
          this.addBox(
            'box1',
            { lng: -114.0, lat: 40.0, height: 300000.0 },
            { width: 400000.0, height: 300000.0, depth: 500000.0 },
            {
              material: Cesium.Color.RED.withAlpha(0.5),
              outline: true,
              outlineColor: Cesium.Color.BLACK
            }
          );

          this.addCircle(
            'circle1',
            { lng: -107.0, lat: 40.0, height: 300000.0 },
            { width: 400000.0, height: 200000.0, depth: 0.0 },
            {
              material: Cesium.Color.BLUE.withAlpha(0.5),
              outline: true,
              outlineColor: Cesium.Color.BLACK
            }
          );
          this.addCylinder(
            'c1',
            { lng: -100.0, lat: 40.0, height: 300000.0 },
            { top: 200000.0, bottom: 200000.0, height: 400000.0 },
            {
              material: Cesium.Color.YELLOW.withAlpha(0.5),
              outline: true,
              outlineColor: Cesium.Color.BLACK
            }
          );
          this.addCorridor(
            'cc',
            { width: 400000.0, height: 200000.0, depth: 0.0 },
            [-80.0, 40.0, -85.0, 40.0, -85.0, 35.0],
            {
              cornerType: Cesium.CornerType.BEVELED,
              material: Cesium.Color.GREEN.withAlpha(0.5),
              outline: true, // height or extrudedHeight must be set for outlines to display
              outlineColor: Cesium.Color.WHITE
            }
          );
          this.addSphere(
            'sphere',
            { lng: -90, lat: 40, height: 0 },
            { width: 300000.0, height: 300000.0, depth: 300000.0 },
            {
              material: Cesium.Color.RED.withAlpha(0.5),
              outline: true,
              outlineColor: Cesium.Color.BLACK
            }
          );
          this.addLine('line', [-80.0, 30.0, -85.0, 30.0, -85.0, 35.0], {
            width: 2,
            arcType: Cesium.ArcType.RHUMB,
            material: Cesium.Color.RED,
            granularity: 0.001
          });
          this.addWall(
            'w',
            Cesium.Cartesian3.fromDegreesArrayHeights([
              -107.0, 43.0, 100000.0, -97.0, 43.0, 100000.0, -97.0, 40.0, 100000.0, -107.0, 40.0,
              100000.0, -107.0, 43.0, 100000.0
            ]),
            {
              material: Cesium.Color.GREEN,
              outline: true
            }
          );
          function computeCircle(radius) {
            const positions = [];
            for (let i = 0; i < 360; i++) {
              const radians = Cesium.Math.toRadians(i);
              positions.push(
                new Cesium.Cartesian2(radius * Math.cos(radians), radius * Math.sin(radians))
              );
            }
            return positions;
          }
          this.addLineShape('line1', [-100.0, 40.0, -80, 40.0], {
            shape: computeCircle(60000.0),
            material: Cesium.Color.RED
          });
          this.addPlane(
            'plane',
            { lng: -100.0, lat: 30.0, height: 300000.0 },
            { width: 400000.0, height: 300000.0 },
            {
              plane: new Cesium.Plane(Cesium.Cartesian3.UNIT_Y, 0.0),
              material: Cesium.Color.GREEN.withAlpha(0.5),
              outline: true,
              outlineColor: Cesium.Color.BLACK
            }
          );
          this.addPloygon(
            'ss',
            Cesium.Cartesian3.fromDegreesArrayHeights([
              -108.0, 25.0, 100000, -100.0, 25.0, 100000, -100.0, 30.0, 100000, -108.0, 30.0, 300000
            ]),
            {
              extrudedHeight: 0,
              perPositionHeight: true,
              textureCoordinates: {
                positions: [
                  new Cesium.Cartesian2(0, 1),
                  new Cesium.Cartesian2(0, 0),
                  new Cesium.Cartesian2(1, 0),
                  new Cesium.Cartesian2(1, 1)
                ]
              },
              material: './test.png'
            }
          );
          this.addRectangle(
            'rect',
            {
              left: -110.0,
              top: 30.0,
              right: -100.0,
              bottom: 40.0,
              height: 100000.0,
              depth: 300000.0
            },
            {
              material: Cesium.Color.BLUE.withAlpha(0.5),
              outline: true, // height must be set for outline to display
              outlineColor: Cesium.Color.BLACK
            }
          );
          this.addLabel('label', { lng: -90.0, lat: 30.0, height: 300000.0 }, 'Hello World', {
            showBackground: true,
            font: '14px monospace'
          });
          this.viewer.zoomTo(this.viewer.entities);
        }
        onClickAction(c, pos) {
          const label = this.getEntityById('label');
          label.position = pos;
          console.log(c, pos, label);
          const lng = Cesium.Math.toDegrees(c.longitude).toFixed(4);
          const lat = Cesium.Math.toDegrees(c.latitude).toFixed(4);
          label.label.text = `lng:${lng}\nlat:${lat}`;
        }
      }

      const my = new MyCesium();
      my.init({
        baseLayerPicker: false,
        terrain: Cesium.Terrain.fromWorldTerrain()
      });
      my.createMap();
    </script>
  </body>
</html>
